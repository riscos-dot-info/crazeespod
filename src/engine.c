/*
 * Copyright 2010, Neil White. All rights reserved.
 * Distributed under the terms of the GPL V 2 License.
 *
 * Authors:
 *      Neil White <neil@cloudsprinter.com>
 */


#include <stdio.h>
#include <string.h>
#include <stdbool.h>
#include "engine.h"
#include "main.h"
#include "images.h"
#include "sound.h"
#include <SDL/SDL_mixer.h>

	

		char *twenty1 = "!!2222222222222222222224111111122111111142212222121111212222122112111212212111211222121222111122212122211212111221112121122121121212212121121221112112111121C21112222121211221121212222211212122221212112221122121122112122112212211121111211122122111121112211121111222121222111122212122211211111221111121122122221222222122221221111112111121111112212212111221112122122411111211112111114222222222222222222222";
		char *twenty2 = "!!2222222222222222222221111112111121111112212222111221112222122112111211112111211222121222122122212122211212111221112121122121121241142121121221212112222221C21212212121211111121212122121212122221212121221211111122111111212212212121111212122122112121112211121211222121222122122212122211211121111211121122122221112211122221221111112111121111112212122121221212212122411111211112111114222222222222222222222";
		
		char *thirty1 = "++222222222222222222222222222222241121111111211111111111111142212121212121212122121222222212212111212121212122121111111112211121112121111112121212222222222222212122221212121211111112211111112112821211121212121212212222212212221222121212111112211111111111111111121212121212212222212222221212121111111112211111112888821212121222221212212222222888821111111111111112211111112888821212222122122212222222212222221211111111111112211111111111114212212222122212212222222122212211111111111112211111111121111112212222122212212121212111212211111112111112212121212122212112121212212212212121212112212122121212212212211121112211112122111111212212212122222221211C12222221111112212128888821212211111111212122212128888821212222122222212122211128888821212882111111112112212122288821212222122222222212212111288821211111121111121112212221222221222222121222121212241111111111111111111111111142222222222222222222222222222222";
		char *thirty2 = "++2222222222222222222222222222222411111111111121111111111111422122212222122111222222212212122121111111112222111111112212122121222122211122122221212212122121211111112112121111111112122111212221222212121221222222122121212111111111111211111111122121112122212122222212222222122121212121111111111111111112122111211121222212212222222212122121112121211111212888888212122122211121212221212888888211122121112111212111212888888212282121222221112121212888888212882111211121211114212888888212882221212121212222212222222212282111212111212111111111111111122121212121212122222212222222122111112121111111111111211111122122222111212121212121112222122128821121211111211121212221122128821211212121212121211111282128821212112121112111212122282128821212121121212121212111122128821211111211112121111222122128221222212112211112121111122122111111212122221211112222122411122221111C1111122221111142222228888222222222288882222222";
		
		char *forty1 = "55222222222222222222222222222222222222222224111111111111211111111111111111111111422122222122121111222222212212122221221212211111112212122211111111221211111122121222222121221212221222212122121221212212122211111111121112121111111112111111111212221221222222121212122122222212212222221221121111111111111112111111111211111111122122122222221122222212222222121212122212211111111111111111111111111112121212221221222121212222122122221222221212111111122111112121211111212882128822121112221212212221112121222121288212882112212211111221211121112121112128821282112821121222222121222221112121212882128212888212121112211121112121111121288212821288821112121222212121212122222122221222122822121212122111212111212111111111111111121112111212212121212121212222221222222212121212121221111121211111111C111121111111111111111221222221112121212121211122222222122222122128821121211111211121212888888211111112212882121121212121212121222222221222221221222212121121211121412111111111111111122111111212121121212121212222222212222212212222121111121111212111288888821111111221282212222121122121121282222222122222122122111111212122212211112111111111111112211112222111111111112221222222122222222221222888822121212121111128888211111111122122222111212121212121212888822212222212212882112121111121112121288888821111121221288212112121212121212122222222122211122128821212112121112111211111111111112212212882121212112121212121222222221221111221288212111112111121211128888882111222122128221222212112211112212222822212111112212211111121212222121111211121111122221224111222211111111112222111211122211111422222288882222222222888822222228882222222"; 
		char *forty2 = "552222222222222222222222222222222222222222211111111111111111111111111111111111111221222121222122222221222222121212121212122111111111112888882128882111111211121112212221222121222222212222212212121212121221111411111122111111211111211211124112122121212121211112222111221221221212121212211111111122122288212122111111121112111221212221222111122221112212212212121212122111111111112211111121111221111112111212212121212121221222222222222212121212121221111111111112111C11111111111111111111122222122222221122222122222221222222212222888212888882212888212888882128888821288888821222222211122221222222212888882128888882111111111211111111111211288888212888888212222222222222212112121228888821288888821288888888888221221211122888882128888882122222228888211111122222222222212888888211121112222211222211111111211121288888821211121111111288882122222111211128888882122222221212112222112888222222212888888212888882121221114112888888888821288888821288888211122122122222222222222128888882128888822222211212111111111111112888888212888882111122111112222122222221288888821288888212211112122211112888882128882222122222221221221211111221222222212222211111111111111112112222112111111111111221212121212122221121211112212212121222122121112111212111211111212111111111111112212121212121212121222121212122121222121221112111211121212121112111211111111111122121212121212121212121212121221222121212212114211121211121212111212111111141111221212121212121212121212121212212122212122111211121112121212111212121111111111112212121212121212121222121212122121212221221111111111111111111111111111111111111122222222222222222222222222222222222222222";
		char *forty3 = "55888222222222222222222222222222222222222282221111111111111121111111111111112111422411112222122122211122222121222121212212212221211111111111211111111111112121211221111111212221222121222222222221211121222122121121222111112128888888882111211112211112122112212221212888888888212121221221212211121111111111288888888821212121122121111212122122212128888888882121112122212122121111211111212888888888211121111221112212222112222121222288888821212122122121111111221111212111112888882121212212212212222111122121221221288888212111111221211111122221111111111128888821222212122111222211111122122212122222222121111212212222222222221111111211111111111121221221111111111111122212221222212121211122122121221222212221111111111111212122211112212111111111111122222212122121211111222221212212222121211114111212112122212111222121221111111112222222121112211221122112211111122222121111C111112212221122122212821222111111122222122221111111111111111282121212222222111111122212221222212222122112121211111112221211211111111111111112212212121222221111122111222122212221221221211112111112222211212222111111111111122121222212221288882121111112222122222212212111111112128888212222122211111111111221121222121212888821111211111221222222128211111112121288888222111222211111111112211212221112128888888212111111212122212821211111122212888888821212222221211111282121212211111288888882121111111121212128212121111222222222222212122122212121212821112222211111111111111212212221212121282121111111212222212222121111111111112112212222122221112111211111122221222122221224111111111121112111222211111111111111422222222222222222222288882222222222222222";
		
		char *fifty1 = "??22222222222222222222222222222222222222222222222222241111111111111111111111221111111111111122111111422122212222121222222122212112122222212221211222221221112128821211111111221111221111111111111128888212212121222212212212211112111112222221222221222222122111211111122122122122221222111111111111112111111282121122222221111111111111111222222222221121212212821212111111112212221222122211111211111111111111122112121212222111111111111111122211121212112121221221221211128882122221222212121111121212121111111112212211222288821111111111111112221212121211212122122112211112222212122221222222111212111111111111111282111212121111111111111111111211111222121121212212821211111112221222212222212122121211111212212111128212212222211111211128882111111112222222111111221282111111111121211121228821212222111C1111122221221282221222222121122221128821111111122222211111111112211111111121121288821282212122211111111122222122222122221221121212888212821111111122222221111111111221211111121212128882128212121222288888212222122212212122121212121222221222121211222888882111111111122121211111111111111111111211211228888882221221221221212121212222222122221212211211222222221111111112212121212128888821288211111211211111111112221222122121212121222288212882121211211122121212111111111221111111111112222122221111212121221212121212212122212221222222111111111112241111211111111211111111122111112111111222222122222221211121221212122122121221222121222212888821288888211212212112121111111212211111212111128888212888882211112121221212222211122122211111221288882122888822212111212111111111122221282122211112888821142888211121221121221222221122212821111122122222212122222121212112212111111121122128212221111111111111111111111111221121212121221221282122222212222121222222121212122112212121111112212221111111128821112888821111111111221111122222282111112222221288822128888212121221211112121288888821222122222212888821288882111111111122211112888888212821111111128888212888821222222222211121228888882128212222221222222122222211111111111122111222222821221111111111111111111111221222122221111211111112212112222121212121212222211111111121112122212212122111288821212121212111111122222121112121111111121222212888212121211121222221111111222221212222122212221128882121112121211111112222211111112111111111122112822211212121212122222111111122222121222122221221282111122121212121111111222221111111211111111112212211222821211121212222211111112222212122221222122411128888211121111111111122222111111111111111114222222888882222222222222222888882222222222222222222";
		char *fifty2 = "??2222222222222222222222222222222222222222222222222224111111111111111111111111111111111121112111222222212221221221221221221221221221221221112111211111422122212212212212212212212212212212221222122212221221111111111111111111C11111111111111111111111112212212122221221221221221221221221221222222222222111122121222212212212212212212212212211111111111111221221211111111111111111111111112122122222122222212212212122222222222122222222222111111111111288882111122121111111111111222221111112212212222212888821221221212222212222212211112222111122128882112888212212212111111111111122121288882121221288822128882111122121222221222221221212888821212212888821222221221221211111111111112212128888212122128888211111112212212122222222222111121288882121221288882122222111122111111111111111222212888821112212888821288821221282222222222222211111128888212122122222212888212212821112111211122122221288882121111111111122222111128212111211121111222212888821212222212121111111221282111211121112212111128888211121142121222221212212822222222222221111222288882222212121211111112111122111111111111112128888888888882111212122222121221221222222122222121288888888888821221121111111212212211111111111111212888888888888212112212222212111122222212222122212128888888888882121211111111121221221111111111111121122222222222221211121212121212212212212222222221221111111111111112121212121212111122121111111111111222122122212222221212111212121221221212121222222211121111111128888212121212121212212212121211111111121112222221288882121212121212111122121212121212121212111111112888824111111111121221221112121212121212121222122122222222222222222212212212121112111111111211111111211111111111111111111122121212122222222122122122212121212222122221222221221212121211111111121111111121212111111111212888212211121212122222221212221221212121222222212122222122121212121111111112111111112111211111111121111111221212111222222221221222222122121121222222212212212212121212111111111211111111211112211111111111111122111212121222222212222222212122222221222122212221221212121211111111111111111121111111111111111111112212121212122221222222222221212212222212212212212122121211111111111111111111112111111111111111111121221112222222222222222222222221212222222212222221212212111111111111111111111111212111111111111111111122122122212212221221222122242121221221221221221221221111111111111111111111111121211111111111111111112222222222222222222222222222212222122221222212222128888888888888888888888888882111111111111111111114288888888888888888888888888882222222222222222222222";
		char *fifty3 = "??8888822222228888222222222222222222288888888888888888882211122222221111111111111111112222222222228888888211121111111112222212222221222111111111114288888882121222222222111111111111111111222222212212888888821212888822222222222222222222222888882111128888888212128888211112111111111111112228888822221288888882141288882122121212122222122111288888888212888888821212888821221212121288821222212888888882128888888212128888211112121212888212882128888888821288888882111288882122121212128882128821288888882112888888882212822221221212121222221222112888888211288888888882128211111111111111111111111282222222122222228888821282122122122221222222122211221111111111111222222212221221221111112888821211211112121212121212211111111111111112222122222212111212121212121212122121222222222222111111111111122222121211121212121221212111222221112222212222221111111212121212121212212111211111112111111128888212122212121211121212122121222221222221222221288882121282121212121211121221212111212221111111112888821212821212121212221212212121212121112122222288888212122111111112111112122121212121212121288888888882111111222212122222121221212121212121112888888888882222211111121111111212212121211121212128888888888888882122221222122211122121212121112121218888888888888821111111111112121221212111212121212888888888882222212221221222111112212121212121212122222228888241111111111112222222222121212121212121111111128882122122222122121111111221212121111111212122121288821121112211111212121212212121212221211111111212888221112111122222121212122111111121111221222212122222112122221111111212111221222222112211211111121221412121221112222212121212241111111288212122221211212121211212221111111212122222222222882111111112212121212211121112222212111288888888882211212122121121112111222212111111121212888888888821121111111112212122211111122222222212128888888888212112212212112121288222222221111111111288888888882121222111122121112888211122212222122212888888888821111122221211212128221121111111111111128888888888212121112112122121282212822221222222122288888888882121212121111121112821112888212888821288888888888821211121212221212128212128882128888212888888888888212121211111112121282121288821288882128888888888882111212222122121112821212888212888821288888888888821212111111111212128212128882122222212888888888888212122221221212121222111288821111111128888888888882121111112212121111111212888212221221288888888888821222221282121212212222128882111111112888888888888211111112821142111111111288822222222228888888888882222222228222222222222222888888888888888";
		
		
		
		char *sixty1 = "II2222222222222222222222222222222222222222222222222222222222222411111111111121111111111111424111111111111121111111111111422122222122222121222212122212121222222122222121222212122212122121112111111111211112128212121211112111111111211112128212122111211121221222212122122212121112211121221222212122122212122122222221111111111111111112111222222221111111111111111112122111111121222222212221212222121111111121222222212221212222122121212121111111111111211111122121212121111111111111211111122121212122122222212221221222121121212122122222212221221222122121212111111111111111211111121221212111111111111111111111122121212212122222122212212121221221212212121221221221212222222111111111111211111111111111111111111111111121111111111111422122221222221212222121222121222222222122222121222212122212122111121111111112111121282121111221112111111111211112128212122122111212212222121221222121221111211121221222212122122212122122222211111111111111111121111222222221111111111111111112122111111212222222122212122221221111111121222222212221212222122212121211111111111112111111111221212121111111111111211111122112121221222222122212212221221221212122122222212221221222122122121111121112122212212111111221212111111111111111221211122112121212111211411111111121221111412212222222222221111112122211121212222222122212122221221221212111111111C1111122221212211211121111111111111211111111111121112122122221212111221212212222122122222212221221222122222222222111111111111121111212211111111111111111111111111111111111112122222221222121222212212121222212122122222122222212222121212111111111111121111112212111111211111111111111111212882121212212222221222122122212212222221212122222212222221212222121211111111111111111121112241121111112112111111111121141112121221222222222222122121222212111212111112122221212111212211111111111112111111111111142212222212222212121111112221212112222212222212122221212221212212111211111111121212212821212122111211111111121111212821212211121112122122221212212221212111121112122122221212212221212212222222111111111111111111212212222222111111111111111111212211111112122222221222121222212211111142122221221222121222212212121212111111111111121111112112121212112821221111121111112212121212212222221222122122212122121212212221221222122122212212121211111111111111122121112112121211111111111111122121112211111221222222222222122121222212121221222222222222122121222212221111111121111111111111411111111111111112111111111111112211111222222121222212122212122212222212222212122121212221212212221111111121111111111111111111111111111112111111111111112211222122222121222212122212122212222212222212122121212221212221112111111111211112128212111112111211111111121111212821112211211121221222212122122212122211121112122121221212212221212212222221111111111111111112111112222222111111111111111111212211111121222222212221212222122211111112122222221222121221212212212121111111111111211111111112121212111111111111111111112212212122122222222221221222122212121212212121221222122122212211111111111211122221221211111112121211111111111111122121112212222221221112111111111112122211121221221212222222111111242211111111222222212221212222122222111211111111111112212221212212221221111111111111211111111111121112122122221212212221212211111122122222212221221222122212222222111111111111111111212212122111111111111111121111114111111112122222221222121222212212122222212122122222122222212212121212111111111111121111112212111111211111111111111111212112121212212222221222122122212212222221212122222212222221212122121211111211121112122121112241111111112111111111111111112111111112221112111211111111222222222222222222222222222222222222222222222222222222222222222";
		
		
		
		
void powerp(Ghost *ghost) {
    int nd;
    ghost->ld = ghost->d;
    if (ghost->m == 0) {
        // get set that last direction ?? bork shut up set to
        // zero
        // for new eh what?
        ghost->m = GFXY;

        // get a new direction yea well done need that

        do { // do while loop until direction isnt zero how is
            // this
            // going to work help!

            if (ghost->d == 0) {
                nd = randoon(4) + 1;
                if (nd == 1 && ghost->ld != 3
                        && squaren[ghost->x + 1][ghost->y] != 2) {
                    {
                        ghost->d = 1;
                        break;
                    }
                }
                if (nd == 2 && ghost->ld != 4
                        && squaren[ghost->x][ghost->y + 1] != 2) {
                    {
                        ghost->d = 2;
                        break;
                    }
                }
                if (nd == 3 && ghost->ld != 1
                        && squaren[ghost->x - 1][ghost->y] != 2) {
                    {
                        ghost->d = 3;
                        break;
                    }
                }
                if (nd == 4 && ghost->ld != 2
                        && squaren[ghost->x][ghost->y - 1] != 2) {
                    {
                        ghost->d = 4;
                        break;
                    }
                }
            }
            if (ghost->d == 1) {
                if (squaren[ghost->x][ghost->y - 1] != 2
                        || squaren[ghost->x][ghost->y + 1] != 2)
                    ghost->d = 0;
            }
            if (ghost->d == 2) {
                if (squaren[ghost->x + 1][ghost->y] != 2
                        || squaren[ghost->x - 1][ghost->y] != 2)
                    ghost->d = 0;
            }
            if (ghost->d == 3) {
                if (squaren[ghost->x][ghost->y - 1] != 2
                        || squaren[ghost->x][ghost->y + 1] != 2)
                    ghost->d = 0;
            }
            if (ghost->d == 4) {
                if (squaren[ghost->x + 1][ghost->y] != 2
                        || squaren[ghost->x - 1][ghost->y] != 2)
                    ghost->d = 0;
            }

            // end of while loop so we got a direction, youd
            // hope
        } while (ghost->d == 0);

    }
    if (ghost->m == GFXY) {
        if (ghost->d == 1)
            ghost->x++;
        if (ghost->d == 2)
            ghost->y++;
        if (ghost->d == 3)
            ghost->x--;
        if (ghost->d == 4)
            ghost->y--;
    }

    if (ghost->m > 0) {
        if (ghost->d == 1) {
            ghost->ox = -2 * ghost->m;
            ghost->oy = 1 * ghost->m;
        }
        if (ghost->d == 2) {
            ghost->ox = -2 * ghost->m;
            ghost->oy = -1 * ghost->m;
        }
        if (ghost->d == 3) {
            ghost->ox = 2 * ghost->m;
            ghost->oy = -1 * ghost->m;
        }
        if (ghost->d == 4) {
            ghost->ox = 2 * ghost->m;
            ghost->oy = 1 * ghost->m;
        }
        ghost->m--;
    }

}

void dorghosts(void) {
    int ek, nd, move;

    // if (gcount == 0) {
    for (ek = 1; ek < tghost; ek++) {
        // this is some heavil average ghost AI which i am oing to try
        // and comment
        // m is ghost animating moving
        for (move = 0; move < rghosts[ek].s; move++) {
            if (rghosts[ek].a == 1 && rghosts[ek].p == 0) {

                rghosts[ek].ld = rghosts[ek].d;
                if (rghosts[ek].m == 0) {
                    // get set that last direction ?? bork shut up set
                    // to
                    // zero
                    // for new eh what?
                    rghosts[ek].m = GFXY;

                    // get a new direction yea well done need that
                    if (rghosts[ek].ld == 0) {
                        do { // do while loop until direction isnt zero
                            // how
                            // is this
                            // going to work help!

                            nd = randoon(4) + 1;
                            if (nd == 1
                                    && squaren[rghosts[ek].x + 1][rghosts[ek].y] != 2) {
                                {
                                    rghosts[ek].d = 1;
                                    break;
                                }
                            }
                            if (nd == 2
                                    && squaren[rghosts[ek].x][rghosts[ek].y + 1] != 2) {
                                {
                                    rghosts[ek].d = 2;
                                    break;
                                }
                            }
                            if (nd == 3
                                    && squaren[rghosts[ek].x - 1][rghosts[ek].y] != 2) {
                                {
                                    rghosts[ek].d = 3;
                                    break;
                                }
                            }
                            if (nd == 4
                                    && squaren[rghosts[ek].x][rghosts[ek].y - 1] != 2) {
                                {
                                    rghosts[ek].d = 4;
                                    break;
                                }
                            }

                            // end of while loop so we got a direction,
                            // youd
                            // hope
                        } while (rghosts[ek].ld == 0);
                    }

                    if (rghosts[ek].ld == 1) {
                        if (squaren[rghosts[ek].x + 1][rghosts[ek].y] == 2)
                            rghosts[ek].d = 4;
                        if (squaren[rghosts[ek].x][rghosts[ek].y + 1] != 2)
                            rghosts[ek].d = 2;
                    }
                    if (rghosts[ek].ld == 2) {
                        if (squaren[rghosts[ek].x][rghosts[ek].y + 1] == 2)
                            rghosts[ek].d = 1;
                        if (squaren[rghosts[ek].x - 1][rghosts[ek].y] != 2)
                            rghosts[ek].d = 3;
                    }
                    if (rghosts[ek].ld == 3) {
                        if (squaren[rghosts[ek].x - 1][rghosts[ek].y] == 2)
                            rghosts[ek].d = 2;
                        if (squaren[rghosts[ek].x][rghosts[ek].y - 1] != 2)
                            rghosts[ek].d = 4;
                    }
                    if (rghosts[ek].ld == 4) {
                        if (squaren[rghosts[ek].x][rghosts[ek].y - 1] == 2)
                            rghosts[ek].d = 3;
                        if (squaren[rghosts[ek].x + 1][rghosts[ek].y] != 2)
                            rghosts[ek].d = 1;
                    }

                }
                if (rghosts[ek].m == GFXY) {
                    if (rghosts[ek].d == 1)
                        rghosts[ek].x++;
                    if (rghosts[ek].d == 2)
                        rghosts[ek].y++;
                    if (rghosts[ek].d == 3)
                        rghosts[ek].x--;
                    if (rghosts[ek].d == 4)
                        rghosts[ek].y--;
                }

                if (rghosts[ek].m > 0) {
                    if (rghosts[ek].d == 1) {
                        rghosts[ek].ox = -2 * rghosts[ek].m;
                        rghosts[ek].oy = 1 * rghosts[ek].m;
                    }
                    if (rghosts[ek].d == 2) {
                        rghosts[ek].ox = -2 * rghosts[ek].m;
                        rghosts[ek].oy = -1 * rghosts[ek].m;
                    }
                    if (rghosts[ek].d == 3) {
                        rghosts[ek].ox = 2 * rghosts[ek].m;
                        rghosts[ek].oy = -1 * rghosts[ek].m;
                    }
                    if (rghosts[ek].d == 4) {
                        rghosts[ek].ox = 2 * rghosts[ek].m;
                        rghosts[ek].oy = 1 * rghosts[ek].m;

                    }
                    rghosts[ek].m--;
                }

            }
            // end of if alive or powerpellet loop
            if (rghosts[ek].p == POWERP) {
                // rghosts[ek].d=0;
                rghosts[ek].os = rghosts[ek].s;
                rghosts[ek].s = randoon(2) + 1;
            }
            if (rghosts[ek].a == 1 && rghosts[ek].p > 0) {
                powerp(&rghosts[ek]);

            }

        }
        // end of loop
        if (rghosts[ek].p > 0) {
	  powernoise=1;
            rghosts[ek].p--;
            if (rghosts[ek].p == 0) {
	     powernoise=0;
                rghosts[ek].s = rghosts[ek].os;
            }
        }
        else { powernoise=0; } 
        if (rghosts[ek].a == 0) {
            rghosts[ek].p++;
            if (rghosts[ek].p == 0) {
                do {
                    newGhost(&rghosts[ek], randoon(levx) + 1,
                            randoon(levy) + 1, 1, 0, 10, 0,
                            rghosts[ek].os, 0, 0);
                } while (squaren[rghosts[ek].x][rghosts[ek].y] > 1);
            }

        }
    }

}

void dolghosts(void) {
    int ek, nd, move;

    // if (gcount == 0) {
    for (ek = 1; ek < tghost; ek++) {
        // this is some heavil average ghost AI which i am oing to try
        // and comment
        // m is ghost animating moving
        for (move = 0; move < lghosts[ek].s; move++) {
            if (lghosts[ek].a == 1 && lghosts[ek].p == 0) {
                lghosts[ek].ld = lghosts[ek].d;
                if (lghosts[ek].m == 0) {
                    // get set that last direction ?? bork shut up set
                    // to
                    // zero
                    // for new eh what?
                    lghosts[ek].m = GFXY;

                    // get a new direction yea well done need that
                    if (lghosts[ek].ld == 0) {
                        do { // do while loop until direction isnt zero
                            // how
                            // is this
                            // going to work help!

                            nd = randoon(4) + 1;
                            if (nd == 1
                                    && squaren[lghosts[ek].x + 1][lghosts[ek].y] != 2) {
                                {
                                    lghosts[ek].d = 1;
                                    break;
                                }
                            }
                            if (nd == 2
                                    && squaren[lghosts[ek].x][lghosts[ek].y + 1] != 2) {
                                {
                                    lghosts[ek].d = 2;
                                    break;
                                }
                            }
                            if (nd == 3
                                    && squaren[lghosts[ek].x - 1][lghosts[ek].y] != 2) {
                                {
                                    lghosts[ek].d = 3;
                                    break;
                                }
                            }
                            if (nd == 4
                                    && squaren[lghosts[ek].x][lghosts[ek].y - 1] != 2) {
                                {
                                    lghosts[ek].d = 4;
                                    break;
                                }
                            }

                            // end of while loop so we got a direction,
                            // youd
                            // hope
                        } while (lghosts[ek].ld == 0);
                    }

                    if (lghosts[ek].ld == 1) {
                        if (squaren[lghosts[ek].x + 1][lghosts[ek].y] == 2)
                            lghosts[ek].d = 2;
                        if (squaren[lghosts[ek].x][lghosts[ek].y - 1] != 2)
                            lghosts[ek].d = 4;
                    }
                    if (lghosts[ek].ld == 2) {
                        if (squaren[lghosts[ek].x][lghosts[ek].y + 1] == 2)
                            lghosts[ek].d = 3;
                        if (squaren[lghosts[ek].x + 1][lghosts[ek].y] != 2)
                            lghosts[ek].d = 1;
                    }
                    if (lghosts[ek].ld == 3) {
                        if (squaren[lghosts[ek].x - 1][lghosts[ek].y] == 2)
                            lghosts[ek].d = 4;
                        if (squaren[lghosts[ek].x][lghosts[ek].y + 1] != 2)
                            lghosts[ek].d = 2;
                    }
                    if (lghosts[ek].ld == 4) {
                        if (squaren[lghosts[ek].x][lghosts[ek].y - 1] == 2)
                            lghosts[ek].d = 1;
                        if (squaren[lghosts[ek].x - 1][lghosts[ek].y] != 2)
                            lghosts[ek].d = 3;
                    }

                }
                if (lghosts[ek].m == GFXY) {
                    if (lghosts[ek].d == 1)
                        lghosts[ek].x++;
                    if (lghosts[ek].d == 2)
                        lghosts[ek].y++;
                    if (lghosts[ek].d == 3)
                        lghosts[ek].x--;
                    if (lghosts[ek].d == 4)
                        lghosts[ek].y--;
                }

                if (lghosts[ek].m > 0) {
                    if (lghosts[ek].d == 1) {
                        lghosts[ek].ox = -2 * lghosts[ek].m;
                        lghosts[ek].oy = 1 * lghosts[ek].m;
                    }
                    if (lghosts[ek].d == 2) {
                        lghosts[ek].ox = -2 * lghosts[ek].m;
                        lghosts[ek].oy = -1 * lghosts[ek].m;

                    }
                    if (lghosts[ek].d == 3) {
                        lghosts[ek].ox = 2 * lghosts[ek].m;
                        lghosts[ek].oy = -1 * lghosts[ek].m;

                    }
                    if (lghosts[ek].d == 4) {
                        lghosts[ek].ox = 2 * lghosts[ek].m;
                        lghosts[ek].oy = 1 * lghosts[ek].m;

                    }
                    lghosts[ek].m--;
                }
            }
            // end of if alive or powerpellet loop
            if (lghosts[ek].p == POWERP) {
                // lghosts[ek].d=0;
                lghosts[ek].os = lghosts[ek].s;
                lghosts[ek].s = randoon(2) + 1;
            }
            if (lghosts[ek].a == 1 && lghosts[ek].p > 0) {
                powerp(&lghosts[ek]);

            }

            if (lghosts[ek].a == 0) {

            }
        }
        if (lghosts[ek].p > 0) {
	  powernoise=1;
            lghosts[ek].p--;
            if (lghosts[ek].p == 0) {
	      powernoise=0;
                lghosts[ek].s = lghosts[ek].os;
            }
        }
         else { powernoise=0;} 
        if (lghosts[ek].a == 0) {
            lghosts[ek].p++;
            if (lghosts[ek].p == 0) {
                do {
                    newGhost(&lghosts[ek], randoon(20) + 1,
                            randoon(20) + 1, 1, 0, 10, 0,
                            lghosts[ek].os, 0, 0);
                } while (squaren[lghosts[ek].x][lghosts[ek].y] > 1);
            }

        }
    }

}

void dotghosts(void) {
    int ek, nd, move;

    // if (gcount == 0) {
    for (ek = 1; ek < tghost; ek++) {
        // this is some heavil average ghost AI which i am oing to try
        // and comment
        // m is ghost animating moving
        for (move = 0; move < tghosts[ek].s; move++) {
            if (tghosts[ek].a == 1 && tghosts[ek].p == 0) {
                tghosts[ek].ld = tghosts[ek].d;
                if (tghosts[ek].m == 0) {
                    // get set that last direction ?? bork shut up set
                    // to
                    // zero
                    // for new eh what?
                    tghosts[ek].m = GFXY;

                    // get a new direction yea well done need that

                    do { // do while loop until direction isnt zero how
                        // is
                        // this
                        // going to work help!

                        if (tghosts[ek].d == 0) {
                            nd = randoon(4) + 1;
                            if (nd == 1
                                    && tghosts[ek].ld != 3
                                    && squaren[tghosts[ek].x + 1][tghosts[ek].y] != 2) {
                                {
                                    tghosts[ek].d = 1;
                                    break;
                                }
                            }
                            if (nd == 2
                                    && tghosts[ek].ld != 4
                                    && squaren[tghosts[ek].x][tghosts[ek].y + 1] != 2) {
                                {
                                    tghosts[ek].d = 2;
                                    break;
                                }
                            }
                            if (nd == 3
                                    && tghosts[ek].ld != 1
                                    && squaren[tghosts[ek].x - 1][tghosts[ek].y] != 2) {
                                {
                                    tghosts[ek].d = 3;
                                    break;
                                }
                            }
                            if (nd == 4
                                    && tghosts[ek].ld != 2
                                    && squaren[tghosts[ek].x][tghosts[ek].y - 1] != 2) {
                                {
                                    tghosts[ek].d = 4;
                                    break;
                                }
                            }
                        }
                        if (tghosts[ek].d == 1) {
                            if (squaren[tghosts[ek].x][tghosts[ek].y - 1] != 2
                                    || squaren[tghosts[ek].x][tghosts[ek].y + 1] != 2)
                                tghosts[ek].d = 0;
                        }
                        if (tghosts[ek].d == 2) {
                            if (squaren[tghosts[ek].x + 1][tghosts[ek].y] != 2
                                    || squaren[tghosts[ek].x - 1][tghosts[ek].y] != 2)
                                tghosts[ek].d = 0;
                        }
                        if (tghosts[ek].d == 3) {
                            if (squaren[tghosts[ek].x][tghosts[ek].y - 1] != 2
                                    || squaren[tghosts[ek].x][tghosts[ek].y + 1] != 2)
                                tghosts[ek].d = 0;
                        }
                        if (tghosts[ek].d == 4) {
                            if (squaren[tghosts[ek].x + 1][tghosts[ek].y] != 2
                                    || squaren[tghosts[ek].x - 1][tghosts[ek].y] != 2)
                                tghosts[ek].d = 0;
                        }

                        // end of while loop so we got a direction, youd
                        // hope
                    } while (tghosts[ek].d == 0);

                }
                if (tghosts[ek].m == GFXY) {
                    if (tghosts[ek].d == 1)
                        tghosts[ek].x++;
                    if (tghosts[ek].d == 2)
                        tghosts[ek].y++;
                    if (tghosts[ek].d == 3)
                        tghosts[ek].x--;
                    if (tghosts[ek].d == 4)
                        tghosts[ek].y--;
                }

                if (tghosts[ek].m > 0) {
                    if (tghosts[ek].d == 1) {
                        tghosts[ek].ox = -2 * tghosts[ek].m;
                        tghosts[ek].oy = 1 * tghosts[ek].m;
                    }
                    if (tghosts[ek].d == 2) {
                        tghosts[ek].ox = -2 * tghosts[ek].m;
                        tghosts[ek].oy = -1 * tghosts[ek].m;

                    }
                    if (tghosts[ek].d == 3) {
                        tghosts[ek].ox = 2 * tghosts[ek].m;
                        tghosts[ek].oy = -1 * tghosts[ek].m;

                    }
                    if (tghosts[ek].d == 4) {
                        tghosts[ek].ox = 2 * tghosts[ek].m;
                        tghosts[ek].oy = 1 * tghosts[ek].m;

                    }
                    tghosts[ek].m--;
                }
            }
            // end of if alive or powerpellet loop
            if (tghosts[ek].p == POWERP) {
                // tghosts[ek].d=0;
                tghosts[ek].os = tghosts[ek].s;
                tghosts[ek].s = randoon(2) + 1;
            }
            if (tghosts[ek].a == 1 && tghosts[ek].p > 0) {
                powerp(&tghosts[ek]);

            }

            if (tghosts[ek].a == 0) {

            }
        }
        if (tghosts[ek].p > 0) {
	  powernoise=1;
            tghosts[ek].p--;
            if (tghosts[ek].p == 0) {
	      powernoise=0;
                tghosts[ek].s = tghosts[ek].os;
            }
        }
         else { powernoise=0;} 
        if (tghosts[ek].a == 0) {
            tghosts[ek].p++;
            if (tghosts[ek].p == 0) {
                do {
                    newGhost(&tghosts[ek], randoon(20) + 1,
                            randoon(20) + 1, 1, 0, 10, 0,
                            tghosts[ek].os, 0, 0);
                } while (squaren[tghosts[ek].x][tghosts[ek].y] > 1 );
            }

        }
    }

}

void dosghosts(void) {
    int ek, nd, move;

    // if (gcount == 0) {
    for (ek = 1; ek < sghost; ek++) {
        // this is some heavil average ghost AI which i am oing to try
        // and comment
        // m is ghost animating moving
        for (move = 0; move < sghosts[ek].s; move++) {
            if (sghosts[ek].a == 1 && sghosts[ek].p == 0) {
                if (sghosts[ek].m == 0) {
                    // get set that last direction ?? bork shut up set
                    // to
                    // zero
                    // for new eh what?
                    sghosts[ek].m = GFXY;

                    sghosts[ek].ld = sghosts[ek].d;
                    // get a new direction yea well done need that
                    do { // do while loop until direction isnt zero how
                        // is
                        // this
                        // going to work help!

                        if (sghosts[ek].d == 0) {
                            nd = randoon(4) + 1;
                            if (nd == 1
                                    && sghosts[ek].ld != nd
                                    && sghosts[ek].ld != 3
                                    && squaren[sghosts[ek].x + 1][sghosts[ek].y] != 2) {
                                sghosts[ek].d = 1;
                                break;
                            }
                            if (nd == 2
                                    && sghosts[ek].ld != nd
                                    && sghosts[ek].ld != 4
                                    && squaren[sghosts[ek].x][sghosts[ek].y + 1] != 2) {
                                sghosts[ek].d = 2;
                                break;
                            }
                            if (nd == 3
                                    && sghosts[ek].ld != nd
                                    && sghosts[ek].ld != 1
                                    && squaren[sghosts[ek].x - 1][sghosts[ek].y] != 2) {
                                sghosts[ek].d = 3;
                                break;
                            }
                            if (nd == 4
                                    && sghosts[ek].ld != nd
                                    && sghosts[ek].ld != 2
                                    && squaren[sghosts[ek].x][sghosts[ek].y - 1] != 2) {
                                sghosts[ek].d = 4;
                                break;
                            }

                        }
                        if (sghosts[ek].d == 1) {
                            if (squaren[sghosts[ek].x][sghosts[ek].y + 1] != 2
                                    && spod.y >= sghosts[ek].y) {
                                sghosts[ek].d = 2;
                                break;
                            }
                            if (squaren[sghosts[ek].x][sghosts[ek].y - 1] != 2
                                    && spod.y <= sghosts[ek].y) {
                                sghosts[ek].d = 4;
                                break;
                            }
                            if (squaren[sghosts[ek].x + 1][sghosts[ek].y] != 2) {
                                sghosts[ek].d = 1;
                                break;
                            }
                            sghosts[ek].d = 0;

                        }
                        if (sghosts[ek].d == 2) {
                            if (squaren[sghosts[ek].x + 1][sghosts[ek].y] != 2
                                    && spod.x >= sghosts[ek].x) {
                                sghosts[ek].d = 1;
                                break;
                            }
                            if (squaren[sghosts[ek].x - 1][sghosts[ek].y] != 2
                                    && spod.x <= sghosts[ek].x) {
                                sghosts[ek].d = 3;
                                break;
                            }
                            if (squaren[sghosts[ek].x][sghosts[ek].y + 1] != 2) {
                                sghosts[ek].d = 2;
                                break;
                            }
                            sghosts[ek].d = 0;
                        }
                        if (sghosts[ek].d == 3) {
                            if (squaren[sghosts[ek].x][sghosts[ek].y + 1] != 2
                                    && spod.y >= sghosts[ek].y) {
                                sghosts[ek].d = 2;
                                break;
                            }
                            if (squaren[sghosts[ek].x][sghosts[ek].y - 1] != 2
                                    && spod.y <= sghosts[ek].y) {
                                sghosts[ek].d = 4;
                                break;
                            }
                            if (squaren[sghosts[ek].x - 1][sghosts[ek].y] != 2) {
                                sghosts[ek].d = 3;
                                break;
                            }
                            sghosts[ek].d = 0;

                        }
                        if (sghosts[ek].d == 4) {
                            if (squaren[sghosts[ek].x + 1][sghosts[ek].y] != 2
                                    && spod.x >= sghosts[ek].x) {
                                sghosts[ek].d = 1;
                                break;
                            }
                            if (squaren[sghosts[ek].x - 1][sghosts[ek].y] != 2
                                    && spod.x <= sghosts[ek].x) {
                                sghosts[ek].d = 3;
                                break;
                            }
                            if (squaren[sghosts[ek].x][sghosts[ek].y - 1] != 2) {
                                sghosts[ek].d = 4;
                                break;
                            }
                            sghosts[ek].d = 0;
                        }
                        // end of while loop so we got a direction, youd
                        // hope
                    } while (sghosts[ek].d == 0);
                }
                if (sghosts[ek].m == GFXY) {
                    if (sghosts[ek].d == 1)
                        sghosts[ek].x++;
                    if (sghosts[ek].d == 2)
                        sghosts[ek].y++;
                    if (sghosts[ek].d == 3)
                        sghosts[ek].x--;
                    if (sghosts[ek].d == 4)
                        sghosts[ek].y--;
                }

                if (sghosts[ek].m > 0) {
                    if (sghosts[ek].d == 1) {
                        sghosts[ek].ox = -2 * sghosts[ek].m;
                        sghosts[ek].oy = 1 * sghosts[ek].m;
                    }
                    if (sghosts[ek].d == 2) {
                        sghosts[ek].ox = -2 * sghosts[ek].m;
                        sghosts[ek].oy = -1 * sghosts[ek].m;

                    }
                    if (sghosts[ek].d == 3) {
                        sghosts[ek].ox = 2 * sghosts[ek].m;
                        sghosts[ek].oy = -1 * sghosts[ek].m;

                    }
                    if (sghosts[ek].d == 4) {
                        sghosts[ek].ox = 2 * sghosts[ek].m;
                        sghosts[ek].oy = 1 * sghosts[ek].m;

                    }
                    sghosts[ek].m--;
                }
            }
            // end of if alive or powerpellet loop
            if (sghosts[ek].p == POWERP) {
                // sghosts[ek].d=0;
                sghosts[ek].os = sghosts[ek].s;
                sghosts[ek].s = randoon(2) + 1;
            }
            if (sghosts[ek].a == 1 && sghosts[ek].p > 0) {
                powerp(&sghosts[ek]);

            }

            if (sghosts[ek].a == 0) {

            }
        }
        if (sghosts[ek].p > 0) {
	  powernoise=1;
            sghosts[ek].p--;
            if (sghosts[ek].p == 0) {
	      powernoise=0;
                sghosts[ek].s = sghosts[ek].os;
            }
        }
         else { powernoise=0;} 
        if (sghosts[ek].a == 0) {
            sghosts[ek].p++;
            if (sghosts[ek].p == 0) {
                do {
                    newGhost(&sghosts[ek], randoon(levx) + 1,
                            randoon(levy) + 1, 1, 0, 10, 0,
                            sghosts[ek].os, 0, 0);
                } while (squaren[sghosts[ek].x][sghosts[ek].y] > 1);
            }

        }
    }

}

void getplots(void) {
    int xg = levx+1 , yg = levy+1 , gfxx = GFXX, gfxy =GFXY, osx = SCREEN_X-((levx*gfxx)), osy = SCREEN_Y-((levy*gfxy)), sx = osx, sy = osy;
    //	fprintf(stderr,"\n");
	  sx = osx + (xg * gfxx);
        sy = osy - (xg * gfxy);
    do {
        do {
	   
            secx[xg][yg] = sx;
            secy[xg][yg] = sy;
	    // fprintf(stderr,"sx %04d sy %04d -  xg %02d yg %02d \n",sx,sy,xg,yg);
	    
            sy -= gfxy;
            sx -= gfxx;
            yg--;
	  
        } while (yg > 0);
	//fprintf(stderr,"\n");
        sx = osx + (xg * gfxx);
        sy = osy - (xg * gfxy);
        yg = levy +1;
        xg--;
    } while (xg > 0);
 
       offx=(SCREEN_X/2)-secx[spod.x][spod.y]-(GFXX/2);
       offy=(SCREEN_Y/2)-secy[spod.x][spod.y]-GFXY;
    
     //  fprintf(stderr,"offx %d offy %d",offx,offy);
       
}

void getlevel(void) {



 
    spod.s = 5;
    spod.d = 1;
    spod.nd = 1;
    spod.open = true;
    spod.ded = false;
    //	offx= -1 * secx[spod.x][spod.y] - ( levx * 32 ) + 160;
    //	offy= -1 * secy[spod.x][spod.y] - ( levy * 16 ) + 120;
  
    char levstring[10000];

  if (level <6 ) {
      levy=randoon(2)+1;
      if ( levy==1 ) {  strcpy(levstring, twenty1 ); }
      if ( levy==2 ) {  strcpy(levstring, twenty2 ); }
   
    }
      if (level >5 && level < 12 ) {
      levy=randoon(2)+1;
      if ( levy==1 ) {  strcpy(levstring, thirty1 ); }
      if ( levy==2 ) {  strcpy(levstring, thirty2 ); }
   
    }
     if (level >11 && level < 17 ) {
      levy=randoon(3)+1;
      if ( levy==1 ) {  strcpy(levstring, forty1 ); }
      if ( levy==2 ) {  strcpy(levstring, forty2 ); }
      if ( levy==3 ) {  strcpy(levstring, forty3 ); }
    }
     if (level >16 && level < 22 ) {
      levy=randoon(3)+1;
      if ( levy==1 ) {  strcpy(levstring, fifty1 ); }
      if ( levy==2 ) {  strcpy(levstring, fifty2 ); }
      if ( levy==3 ) {  strcpy(levstring, fifty3 ); }
    }
    if (level > 21 ) {  strcpy(levstring, sixty1 ); }
    blobs = 0;
   
    int x, y, bit = 2;
    levx = levstring[0] - 13;
    levy = levstring[1] - 13;
    fprintf(stderr,"\n levx %d levy %d \n",levx,levy);
    for (y = 1; y < levx +1 ; y++) {
        for (x = 1; x < levy+1 ; x++) {
            crap = levstring[bit] - 48;

           
	    if (crap==19) 
	    {
	      spod.x=x;spod.y=y;
	      spodx=x;spody=y;
	     crap=0;
	    //  fprintf(stderr,"spodx %02d spody %02d",x,y);
	    }
	    
	     squaren[x][y] = crap;
	    
            if (crap == 4 || crap == 1) {
                blobs++;
            }

            bit++;
        }
    }
    sghost = 2+(level/3); tghost = 2+(level/3);    lghost = 2+(level/3); rghost = 2+(level/3);
    
    getghosts();

   
}



void getghosts(void ) {
    for (inc = 1; inc < sghost; inc++) {
        do {
            newGhost(&sghosts[inc], randoon(levx) + 1, randoon(levy) + 1, 1, 0, 10, 0, (inc/3) + 2, 0, 0);
        } while (squaren[sghosts[inc].x][sghosts[inc].y] > 1);

    }
   
    for (inc = 1; inc < tghost; inc++) {
        do {
            newGhost(&tghosts[inc], randoon(levx) + 1, randoon(levy) + 1, 1, 0, 10, 0, (inc/3) + 2, 0, 0);
        } while (squaren[tghosts[inc].x][tghosts[inc].y] > 1);

    }

    for (inc = 1; inc < lghost; inc++) {
        do {
            newGhost(&lghosts[inc], randoon(levx) + 1, randoon(levy) + 1, 1, 0, 10, 0, (inc/3) + 2, 0, 0);
        } while (squaren[lghosts[inc].x][lghosts[inc].y] > 1);

    }
   
    for (inc = 1; inc < rghost; inc++) {
        do {
            newGhost(&rghosts[inc], randoon(levx) + 1, randoon(levy) + 1, 1, 0, 10, 0, (inc/3) + 2, 0, 0);
        } while (squaren[rghosts[inc].x][rghosts[inc].y] > 1);

    }
     powerpill = 10;
    boost = 0;
    }

void newGhost(Ghost *ghost, int sx, int sy, int sa, int sd, int sp, int sm, int ss,
        int sox, int soy) {
    ghost->x = sx;
    ghost->y = sy;
    ghost->a = sa;
    ghost->d = sd;
    ghost->ld = sd;
    ghost->p = sp;
    ghost->m = sm;
    ghost->s = ss;
    ghost->os = ss;
    ghost->ox = sox;
    ghost->ox = soy;
}

void dokeys(void) {
  if (mb==1 && multibutton[0].on==2) {
				if (mx > centerx && my < centery) {
					ur_down = true;
					dl_down = false;
					ul_down = false;
					dr_down = false;
				}
				if (mx < centerx && my > centery) {
					dl_down = true;
					ur_down = false;
					ul_down = false;
					dr_down = false;

				}
				if (mx < centerx && my < centery) {
					ul_down = true;
					ur_down = false;
					dr_down = false;
					dl_down = false;

				}
				if (mx > centerx && my > centery) {
					dr_down = true;
					ur_down = false;
					dl_down = false;
					ul_down = false;

				}
			}
    if (dl_down && !ur_down && !ul_down && !dr_down) {
        spod.nd = 3;
    }
    if (!dl_down && ur_down && !ul_down && !dr_down) {
        spod.nd = 1;
    }
    if (!dl_down && !ur_down && ul_down && !dr_down) {
        spod.nd = 4;
    }
    if (!dl_down && !ur_down && !ul_down && dr_down) {
        spod.nd = 2;
    }
}


void dospod(void) {
    int move, ek;

    if (spod.ded == false) {

        for (move = 0; move < spod.s; move++) {
            if (spod.m == 0) {
                if (spod.d == 1 && squaren[spod.x+1][spod.y]!=2 ) {
                    spod.ox = -2 * spod.m;
                    spod.oy = 1 * spod.m;
		    spod.m=GFXY;
                }
                if (spod.d == 2 && squaren[spod.x][spod.y+1]!=2 ) {
                    spod.ox = -2 * spod.m;
                    spod.oy = -1 * spod.m;
		    spod.m=GFXY;
                }
                if (spod.d == 3 && squaren[spod.x-1][spod.y]!=2) {
                    spod.ox = 2 * spod.m;
                    spod.oy = 1 * spod.m;
		    spod.m=GFXY;
                }
                if (spod.d == 4 && squaren[spod.x][spod.y-1]!=2 ) {
                    spod.ox = 2 * spod.m;
                    spod.oy = 1 * spod.m;
		    spod.m=GFXY;
                }
                
		
		if ( spod.d==1 && spod.nd==3 )
		{
		  spod.d=3;spod.m=GFXY;spod.nd=0;
		}
		if ( spod.d==3 && spod.nd==1 )
		{
		  spod.d=1;spod.m=GFXY;spod.nd=0;
		}
		if ( spod.d==2 && spod.nd==4 )
		{
		  spod.d=4;spod.m=GFXY;spod.nd=0;
		}
		if ( spod.d==4 && spod.nd==2 )
		{
		  spod.d=2;spod.m=GFXY;spod.nd=0;
		}
		
		if ( squaren[spod.x][spod.y+1]!=2 && spod.nd==2 ) { spod.d=2; spod.m=GFXY;spod.nd=0;}
		
		if ( squaren[spod.x][spod.y-1]!=2 && spod.nd==4 ) { spod.d=4;spod.m=GFXY;spod.nd=0; }
		
		if ( squaren[spod.x+1][spod.y]!=2 && spod.nd==1 ) { spod.d=1;spod.m=GFXY;spod.nd=0; }
		
		if ( squaren[spod.x-1][spod.y]!=2 && spod.nd==3 ) { spod.d=3;spod.m=GFXY;spod.nd=0; }
		  
		
		
            }
            if (spod.m == GFXY) {
                if (spod.d == 1) {
                    spod.x++;

                }
                if (spod.d == 2) {
                    spod.y++;

                }
                if (spod.d == 3) {
                    spod.x--;

                }
                if (spod.d == 4) {
                    spod.y--;

                }

            }
            // hlafway ish through moving get the pellets if there are
            // any
	    if (stupidmouth==(GFXY/2) ) {
	//      fprintf(stderr,"%d  spod.s %d boosting %d \n ",boost,spod.s,boosting);
	    if (squaren[spod.x][spod.y] == 4
                        || squaren[spod.x][spod.y] == 1) {
                    boost += 1;
	    if (boost > 10) {
		  boost=10;
                    boosting = 20;
                    if (spod.s < 9) {
                        spod.s++;
                    }
                    ;
                }
		
                }
                
		 if (boosting > 0) {
                boosting--; 
		if (boost>0) {boost  -=1;}}
                if (boosting <= 0) {
                    if (spod.s > 5) {
                        spod.s--;
                    }
               
            
                  
                }
                
                
	}
            if (spod.m == GFXY/2) {
                
                if (squaren[spod.x][spod.y] == 1) {
                    // we got a pellet thing wooo
play_sound(1);
                    squaren[spod.x][spod.y] = 0;
		    score+=spod.s;
                    blobs--;

                }
                if (squaren[spod.x][spod.y] == 4) {
                    // we got a power pellet thing wooo
		
		 
		   play_sound(4);
	
                    squaren[spod.x][spod.y] = 0;
                    blobs--;
                    for (ek = 1; ek < tghost; ek++) {
                        if (tghosts[ek].a == 1)
                            tghosts[ek].p = POWERP;
                    }
                    for (ek = 1; ek < rghost; ek++) {
                        if (rghosts[ek].a == 1)
                            rghosts[ek].p = POWERP;
                    }
                    for (ek = 1; ek < lghost; ek++) {
                        if (lghosts[ek].a == 1)
                            lghosts[ek].p = POWERP;
                    }
                    for (ek = 1; ek < sghost; ek++) {
                        if (sghosts[ek].a == 1)
                            sghosts[ek].p = POWERP;
                    }
                }

            }
            
            if (spod.m > 0) {
                if (spod.d == 1) {
                    spod.ox = -2 * spod.m;
                    spod.oy = 1 * spod.m;
                    offx -= 2;
                    offy += 1;
                }
                if (spod.d == 2) {
                    spod.ox = -2 * spod.m;
                    spod.oy = -1 * spod.m;
                    offy -= 1;
                    offx -= 2;
                }
                if (spod.d == 3) {
                    spod.ox = 2 * spod.m;
                    spod.oy = -1 * spod.m;
                    offx += 2;
                    offy -= 1;
                }
                if (spod.d == 4) {
                    spod.ox = 2 * spod.m;
                    spod.oy = 1 * spod.m;
                    offy += 1;
                    offx += 2;
                }
                spod.m--;
            }
        }
    } else {
     
        if (spod.d < 4) {
	
            spod.d++;
        } else {
            if (spod.open == true) {
                spod.d = 5;
                spod.oy -= 8;
            } else {
                spod.d = 4;
                spod.oy -= 8;
            }
            spod.open = !spod.open;
        }
    }
if (stupidmouth<GFXY-1 ) { stupidmouth++; } else { stupidmouth=0 ; }
}

bool hitme(int gx, int gy, int px, int py) {
    int h = (8*GAP) + spod.s;

    if (gx < px + h && gx > px - h && gy - h < py + (h / 2)
            && gy > py - (h / 2)) {
        return true;
    } else {
        return false;
    }

}

void checkbite(void) {
    int ek;
    bool hit;
    for (ek = 1; ek < tghost; ek++) {
        hit = hitme(
                secx[tghosts[ek].x][tghosts[ek].y] + tghosts[ek].ox,
                secy[tghosts[ek].x][tghosts[ek].y] + tghosts[ek].oy,
                secx[spod.x][spod.y] + spod.ox, secy[spod.x][spod.y]
                + spod.oy);
        if (tghosts[ek].p > 0 && hit) {
            tghosts[ek].p = -1 * POWERP / 2;
            tghosts[ek].a = 0;
            score += 100;
	       play_sound(3);
        }
        if (tghosts[ek].p == 0 && hit) {
            spod.ded = true;
        }
    }
    for (ek = 1; ek < lghost; ek++) {
        hit = hitme(
                secx[lghosts[ek].x][lghosts[ek].y] + lghosts[ek].ox,
                secy[lghosts[ek].x][lghosts[ek].y] + lghosts[ek].oy,
                secx[spod.x][spod.y] + spod.ox, secy[spod.x][spod.y]
                + spod.oy);
        if (lghosts[ek].p > 0 && hit) {
            lghosts[ek].p = -1 * POWERP / 2;
            lghosts[ek].a = 0;
            score += 100;
	    play_sound(3);
        }
        if (lghosts[ek].p == 0 && hit) {
            spod.ded = true;
        }
    }
    for (ek = 1; ek < rghost; ek++) {
        hit = hitme(
                secx[rghosts[ek].x][rghosts[ek].y] + rghosts[ek].ox,
                secy[rghosts[ek].x][rghosts[ek].y] + rghosts[ek].oy,
                secx[spod.x][spod.y] + spod.ox, secy[spod.x][spod.y]
                + spod.oy);
        if (rghosts[ek].p > 0 && hit) {
            rghosts[ek].p = -1 * POWERP / 2;
            rghosts[ek].a = 0;
            score += 100;
	    play_sound(3);
        }
        if (rghosts[ek].p == 0 && hit) {
            spod.ded = true;
        }
    }
    for (ek = 1; ek < sghost; ek++) {
        hit = hitme(
                secx[sghosts[ek].x][sghosts[ek].y] + sghosts[ek].ox,
                secy[sghosts[ek].x][sghosts[ek].y] + sghosts[ek].oy,
                secx[spod.x][spod.y] + spod.ox, secy[spod.x][spod.y]
                + spod.oy);
        if (sghosts[ek].p > 0 && hit) {
            sghosts[ek].p = -1 * POWERP / 2;
            sghosts[ek].a = 0;
            score += 100;
	    play_sound(3);
        }
        if (sghosts[ek].p == 0 && hit) {
            spod.ded = true;
        }
    }
    if (spod.ded == true) {
      play_sound(2);
        spod.d = 1;
        spod.open = true;
    }

}

void doDraw(void) {
    int x, y;
    // empmy canvas
    // canvas.clipRect(0, 0, 320, 240);
    #ifdef BIGASS
    offx=0;offy=0;
    #endif

    for (y = 1; y < levy + 1; y++) {
        for (x = levx; x > 0; x--) {
            // offx=spod.ox;offy=spod.oy;
	    #ifndef BIGASS
              if (secx[x][y] + offx >= -64*GAP && secx[x][y] + offx <= SCREEN_X + (64*GAP)
                    && secy[x][y] + offy >= -64*GAP
                    && secy[x][y] + offy <= SCREEN_Y+(64*GAP))  {
	      #endif

                if (squaren[x][y] == 2) {
                    plotimage(pole, secx[x][y] + offx,
                            secy[x][y] + offy);
                }
                if (squaren[x][y] == 1 || squaren[x][y] == 4 || squaren[x][y] == 0) {
                    plotimage(floorb, secx[x][y] + offx,
                            secy[x][y] + offy);
                }
	    #ifndef BIGASS
            }
            #endif
        }
    }
    for (y = 1; y < levy + 1; y++) {
        for (x = levx; x > 0; x--) {
            // offx=spod.ox;offy=spod.oy;
	    #ifndef BIGASS
            if (secx[x][y] + offx >= -64*GAP && secx[x][y] + offx <= SCREEN_X + (64*GAP)
                    && secy[x][y] + offy >= -64*GAP
                    && secy[x][y] + offy <= SCREEN_Y+(64*GAP) ) {
	      #endif
                if (squaren[x][y] == 2) {
                    offy -= 4;
                    if (squaren[x + 1][y] != 2
                            && squaren[x + 1][y - 1] == 2
                            && squaren[x][y - 1] != 2) {
                        plotimage(wall[17], secx[x][y] + offx,
                                secy[x][y] + offy - GFXY);
                    }
                    if (squaren[x - 1][y] != 2
                            && squaren[x - 1][y - 1] == 2
                            && squaren[x][y - 1] != 2) {
                        plotimage(wall[16], secx[x][y] + offx
                                - GFXX, secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] != 2
                            && squaren[x - 1][y] != 2
                            && squaren[x][y + 1] != 2
                            && squaren[x][y - 1] != 2) {
                        plotimage(wall[0], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] == 2
                            && squaren[x - 1][y] == 2
                            && squaren[x][y + 1] == 2
                            && squaren[x][y - 1] == 2) {
                        plotimage(wall[1], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] == 2
                            && squaren[x][y + 1] != 2
                            && squaren[x - 1][y] != 2
                            && squaren[x][y - 1] == 2) {
                        plotimage(wall[2], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] == 2
                            && squaren[x][y + 1] == 2
                            && squaren[x - 1][y] != 2
                            && squaren[x][y - 1] != 2) {
                        plotimage(wall[3], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] != 2
                            && squaren[x][y + 1] == 2
                            && squaren[x - 1][y] == 2
                            && squaren[x][y - 1] != 2) {
                        plotimage(wall[4], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] != 2
                            && squaren[x][y + 1] != 2
                            && squaren[x - 1][y] == 2
                            && squaren[x][y - 1] == 2) {
                        plotimage(wall[5], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] == 2
                            && squaren[x][y + 1] == 2
                            && squaren[x - 1][y] != 2
                            && squaren[x][y - 1] == 2) {
                        plotimage(wall[6], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] == 2
                            && squaren[x][y + 1] == 2
                            && squaren[x - 1][y] == 2
                            && squaren[x][y - 1] != 2) {
                        plotimage(wall[7], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] != 2
                            && squaren[x][y + 1] == 2
                            && squaren[x - 1][y] == 2
                            && squaren[x][y - 1] == 2) {
                        plotimage(wall[8], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] == 2
                            && squaren[x][y + 1] != 2
                            && squaren[x - 1][y] == 2
                            && squaren[x][y - 1] == 2) {
                        plotimage(wall[9], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] == 2
                            && squaren[x][y + 1] != 2
                            && squaren[x - 1][y] == 2
                            && squaren[x][y - 1] != 2) {
                        plotimage(wall[10], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] != 2
                            && squaren[x][y + 1] == 2
                            && squaren[x - 1][y] != 2
                            && squaren[x][y - 1] == 2) {
                        plotimage(wall[11], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] != 2
                            && squaren[x][y + 1] != 2
                            && squaren[x - 1][y] == 2
                            && squaren[x][y - 1] != 2) {
                        plotimage(wall[14], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] != 2
                            && squaren[x][y + 1] != 2
                            && squaren[x - 1][y] != 2
                            && squaren[x][y - 1] == 2) {
                        plotimage(wall[15], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] == 2
                            && squaren[x][y + 1] != 2
                            && squaren[x - 1][y] != 2
                            && squaren[x][y - 1] != 2) {
                        plotimage(wall[12], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x + 1][y] != 2
                            && squaren[x][y + 1] == 2
                            && squaren[x - 1][y] != 2
                            && squaren[x][y - 1] != 2) {
                        plotimage(wall[13], secx[x][y] + offx,
                                secy[x][y] + offy);
                    }
                    if (squaren[x - 1][y] != 2
                            && squaren[x - 1][y - 1] == 2
                            && squaren[x][y - 1] != 2) {
                        plotimage(wall[16], secx[x][y] + offx
                                - GFXX, secy[x][y] + offy);
                    }
                    offy += 4;
                }

                if (squaren[x][y] == 1)
                    plotimage(blib, secx[x][y] + offx,
                        secy[x][y] + offy);

                if (squaren[x][y] == 4)
                    plotimage(pp, secx[x][y] + offx, secy[x][y]
                        + offy);

                if (spod.x == x && spod.y == y) {
                    if (spod.ded == false) {
                        if (spod.open) {
                            plotimage(spodo[spod.d],
                                    secx[spod.x][spod.y] + offx
                                    + spod.ox,
                                    secy[spod.x][spod.y] + offy
                                    + spod.oy);
                        } else {
                            plotimage(spodc[spod.d],
                                    secx[spod.x][spod.y] + offx
                                    + spod.ox,
                                    secy[spod.x][spod.y] + offy
                                    + spod.oy);
                        }
                       if ( stupidmouth%(GFXY/4)==0 ) { spod.open = !spod.open;}
                    } else {
	
                        plotimage(spodd[spod.d],
                                secx[spod.x][spod.y] + offx + spod.ox,
                                secy[spod.x][spod.y] + offy + spod.oy
                                );
                    }
                }
                for (ek = 1; ek < sghost; ek++) {
                    if (sghosts[ek].x == x && sghosts[ek].y == y
                            && sghosts[ek].a == 1) {

                        if (sghosts[ek].d == 1 || sghosts[ek].d == 4) {
                            plotimage(eyes[sghosts[ek].d],
                                    secx[sghosts[ek].x][sghosts[ek].y]
                                    + offx + sghosts[ek].ox,
                                    secy[sghosts[ek].x][sghosts[ek].y]
                                    + offy + sghosts[ek].oy);
                        }
                        if (sghosts[ek].p == 0) {
                            plotimage(sghostb,
                                    secx[sghosts[ek].x][sghosts[ek].y]
                                    + offx + sghosts[ek].ox,
                                    secy[sghosts[ek].x][sghosts[ek].y]
                                    + offy + sghosts[ek].oy);

                        }
                        if (sghosts[ek].p > 0) {
                            if (sghosts[ek].p > 50) {
                                plotimage(
                                        gghostb,
                                        secx[sghosts[ek].x][sghosts[ek].y]
                                        + offx
                                        + sghosts[ek].ox,
                                        secy[sghosts[ek].x][sghosts[ek].y]
                                        + offy
                                        + sghosts[ek].oy);
                            } else {
                                if (sghosts[ek].p % 2 == 0) {
                                    plotimage(
                                            gghostb,
                                            secx[sghosts[ek].x][sghosts[ek].y]
                                            + offx
                                            + sghosts[ek].ox,
                                            secy[sghosts[ek].x][sghosts[ek].y]
                                            + offy
                                            + sghosts[ek].oy);
                                } else {
                                    plotimage(
                                            aghostb,
                                            secx[sghosts[ek].x][sghosts[ek].y]
                                            + offx
                                            + sghosts[ek].ox,
                                            secy[sghosts[ek].x][sghosts[ek].y]
                                            + offy
                                            + sghosts[ek].oy);
                                }
                            }
                        }

                        if (sghosts[ek].d == 3 || sghosts[ek].d == 2) {
                            plotimage(eyes[sghosts[ek].d],
                                    secx[sghosts[ek].x][sghosts[ek].y]
                                    + offx + sghosts[ek].ox,
                                    secy[sghosts[ek].x][sghosts[ek].y]
                                    + offy + sghosts[ek].oy);
                        }
                    }
                    if (sghosts[ek].x == x && sghosts[ek].y == y
                            && sghosts[ek].p < -80) {

                        plotimage(dghostb,
                                secx[sghosts[ek].x][sghosts[ek].y]
                                + offx + sghosts[ek].ox,
                                secy[sghosts[ek].x][sghosts[ek].y]
                                + offy + sghosts[ek].oy);
                        sghosts[ek].oy -= 6;
                    }
                }

                for (ek = 1; ek < tghost; ek++) {
                    if (tghosts[ek].x == x && tghosts[ek].y == y
                            && tghosts[ek].a == 1) {

                        if (tghosts[ek].d == 1 || tghosts[ek].d == 4) {
                            plotimage(eyes[tghosts[ek].d],
                                    secx[tghosts[ek].x][tghosts[ek].y]
                                    + offx + tghosts[ek].ox,
                                    secy[tghosts[ek].x][tghosts[ek].y]
                                    + offy + tghosts[ek].oy);
                        }
                        if (tghosts[ek].p == 0) {
                            plotimage(tghostb,
                                    secx[tghosts[ek].x][tghosts[ek].y]
                                    + offx + tghosts[ek].ox,
                                    secy[tghosts[ek].x][tghosts[ek].y]
                                    + offy + tghosts[ek].oy);

                        }
                        if (tghosts[ek].p > 0) {
                            if (tghosts[ek].p > 50) {
                                plotimage(
                                        gghostb,
                                        secx[tghosts[ek].x][tghosts[ek].y]
                                        + offx
                                        + tghosts[ek].ox,
                                        secy[tghosts[ek].x][tghosts[ek].y]
                                        + offy
                                        + tghosts[ek].oy);
                            } else {
                                if (tghosts[ek].p % 2 == 0) {
                                    plotimage(
                                            gghostb,
                                            secx[tghosts[ek].x][tghosts[ek].y]
                                            + offx
                                            + tghosts[ek].ox,
                                            secy[tghosts[ek].x][tghosts[ek].y]
                                            + offy
                                            + tghosts[ek].oy);
                                } else {
                                    plotimage(
                                            aghostb,
                                            secx[tghosts[ek].x][tghosts[ek].y]
                                            + offx
                                            + tghosts[ek].ox,
                                            secy[tghosts[ek].x][tghosts[ek].y]
                                            + offy
                                            + tghosts[ek].oy);
                                }
                            }
                        }

                        if (tghosts[ek].d == 3 || tghosts[ek].d == 2) {
                            plotimage(eyes[tghosts[ek].d],
                                    secx[tghosts[ek].x][tghosts[ek].y]
                                    + offx + tghosts[ek].ox,
                                    secy[tghosts[ek].x][tghosts[ek].y]
                                    + offy + tghosts[ek].oy);
                        }
                    }
                    if (tghosts[ek].x == x && tghosts[ek].y == y
                            && tghosts[ek].p < -80) {

                        plotimage(dghostb,
                                secx[tghosts[ek].x][tghosts[ek].y]
                                + offx + tghosts[ek].ox,
                                secy[tghosts[ek].x][tghosts[ek].y]
                                + offy + tghosts[ek].oy);
                        tghosts[ek].oy -= 6;
                    }

                }
                for (ek = 1; ek < lghost; ek++) {
                    if (lghosts[ek].x == x && lghosts[ek].y == y
                            && lghosts[ek].a == 1) {

                        if (lghosts[ek].d == 1 || lghosts[ek].d == 4) {
                            plotimage(eyes[lghosts[ek].d],
                                    secx[lghosts[ek].x][lghosts[ek].y]
                                    + offx + lghosts[ek].ox,
                                    secy[lghosts[ek].x][lghosts[ek].y]
                                    + offy + lghosts[ek].oy);
                        }
                        if (lghosts[ek].p == 0) {
                            plotimage(lghostb,
                                    secx[lghosts[ek].x][lghosts[ek].y]
                                    + offx + lghosts[ek].ox,
                                    secy[lghosts[ek].x][lghosts[ek].y]
                                    + offy + lghosts[ek].oy);

                        }
                        if (lghosts[ek].p > 0) {
                            if (lghosts[ek].p > 50) {
                                plotimage(
                                        gghostb,
                                        secx[lghosts[ek].x][lghosts[ek].y]
                                        + offx
                                        + lghosts[ek].ox,
                                        secy[lghosts[ek].x][lghosts[ek].y]
                                        + offy
                                        + lghosts[ek].oy);
                            } else {
                                if (lghosts[ek].p % 2 == 0) {
                                    plotimage(
                                            gghostb,
                                            secx[lghosts[ek].x][lghosts[ek].y]
                                            + offx
                                            + lghosts[ek].ox,
                                            secy[lghosts[ek].x][lghosts[ek].y]
                                            + offy
                                            + lghosts[ek].oy);
                                } else {
                                    plotimage(
                                            aghostb,
                                            secx[lghosts[ek].x][lghosts[ek].y]
                                            + offx
                                            + lghosts[ek].ox,
                                            secy[lghosts[ek].x][lghosts[ek].y]
                                            + offy
                                            + lghosts[ek].oy);
                                }
                            }
                        }

                        if (lghosts[ek].d == 3 || lghosts[ek].d == 2) {
                            plotimage(eyes[lghosts[ek].d],
                                    secx[lghosts[ek].x][lghosts[ek].y]
                                    + offx + lghosts[ek].ox,
                                    secy[lghosts[ek].x][lghosts[ek].y]
                                    + offy + lghosts[ek].oy);
                        }
                    }
                    if (lghosts[ek].x == x && lghosts[ek].y == y
                            && lghosts[ek].p < -80) {

                        plotimage(dghostb,
                                secx[lghosts[ek].x][lghosts[ek].y]
                                + offx + lghosts[ek].ox,
                                secy[lghosts[ek].x][lghosts[ek].y]
                                + offy + lghosts[ek].oy);
                        lghosts[ek].oy -= 6;
                    }

                }
                for (ek = 1; ek < lghost; ek++) {
                    if (rghosts[ek].x == x && rghosts[ek].y == y
                            && rghosts[ek].a == 1) {

                        if (rghosts[ek].d == 1 || rghosts[ek].d == 4) {
                            plotimage(eyes[rghosts[ek].d],
                                    secx[rghosts[ek].x][rghosts[ek].y]
                                    + offx + rghosts[ek].ox,
                                    secy[rghosts[ek].x][rghosts[ek].y]
                                    + offy + rghosts[ek].oy);
                        }
                        if (rghosts[ek].p == 0) {
                            plotimage(rghostb,
                                    secx[rghosts[ek].x][rghosts[ek].y]
                                    + offx + rghosts[ek].ox,
                                    secy[rghosts[ek].x][rghosts[ek].y]
                                    + offy + rghosts[ek].oy);

                        }
                        if (rghosts[ek].p > 0) {
                            if (rghosts[ek].p > 50) {
                                plotimage(
                                        gghostb,
                                        secx[rghosts[ek].x][rghosts[ek].y]
                                        + offx
                                        + rghosts[ek].ox,
                                        secy[rghosts[ek].x][rghosts[ek].y]
                                        + offy
                                        + rghosts[ek].oy);
                            } else {
                                if (rghosts[ek].p % 2 == 0) {
                                    plotimage(
                                            gghostb,
                                            secx[rghosts[ek].x][rghosts[ek].y]
                                            + offx
                                            + rghosts[ek].ox,
                                            secy[rghosts[ek].x][rghosts[ek].y]
                                            + offy
                                            + rghosts[ek].oy);
                                } else {
                                    plotimage(
                                            aghostb,
                                            secx[rghosts[ek].x][rghosts[ek].y]
                                            + offx
                                            + rghosts[ek].ox,
                                            secy[rghosts[ek].x][rghosts[ek].y]
                                            + offy
                                            + rghosts[ek].oy);
                                }
                            }
                        }

                        if (rghosts[ek].d == 3 || rghosts[ek].d == 2) {
                            plotimage(eyes[rghosts[ek].d],
                                    secx[rghosts[ek].x][rghosts[ek].y]
                                    + offx + rghosts[ek].ox,
                                    secy[rghosts[ek].x][rghosts[ek].y]
                                    + offy + rghosts[ek].oy);
                        }
                    }
                    if (rghosts[ek].x == x && rghosts[ek].y == y
                            && rghosts[ek].p < -80) {

                        plotimage(dghostb,
                                secx[rghosts[ek].x][rghosts[ek].y]
                                + offx + rghosts[ek].ox,
                                secy[rghosts[ek].x][rghosts[ek].y]
                                + offy + rghosts[ek].oy);
                        rghosts[ek].oy -= 6;
                    }
                }
                #ifndef BIGASS
            }
            #endif
        }

    }
    // canvas.drawARGB(255, 0, 0, 0);

    // plotimage(mCman, x, y );

}

 void doFloor(void) {
			
			int x,y;
			for (x = -64; x < SCREEN_X+64; x += 64) {
				for (y = -GFXX; y < SCREEN_Y+GFXX; y += GFXX) {
					plotimage(floorb, x, y);
					plotimage(floorb, x + GFXX, y + GFXY);
				}
			}
		}


